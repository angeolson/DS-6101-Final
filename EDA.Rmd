---
title: "Exploratory Data Analysis"
author: "Meghana, Kowshik"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
library(ezids)
library(ggplot2)
```

```{r, results='markup'}
music = data.frame(read.csv("music_genre.csv"))
head(music)
```

```{r, results='markup'}
colnames(music)
```

```{r, results='markup'}
str(music)
xkablesummary(music)
```

```{r}
# changing 
music$key <- factor(music$key)
music$mode <- factor(music$mode)
music$music_genre <- factor(music$music_genre)
music$tempo <- as.numeric(music$tempo)

# checking and removing null values
paste0("Before removing missing values:", nrow(music))
print(colSums(is.na(music)))
music = na.omit(music)
paste0("After removing missing values:", nrow(music))
```
```{r}
#seperating numeric values
numcolumns <- unlist(lapply(music,is.numeric))
music_cor <- music[,numcolumns]
music_cor <- music_cor[,-c(1)]
head(music_cor, 5)
```
```{r}
# Correlations
loadPkg("corrplot")
corrplot(cor(music_cor, method = "spearman"), method = "circle", type = 'lower', order = 'hclust', tl.col = 'black',
         cl.ratio = 0.1, tl.srt = 45, col = COL2('PRGn', 10))

```
# To see categories in the music_genre
```{r, results='markup'}
unique(music$music_genre)
```

# Scatterplot to see energy of the song by genre wise
```{r, results='markup'}
library(ggplot2)
library(ggpubr)
ggplot(music, aes(x=c(music_genre), y=energy)) + 
  ggtitle("Energy vs Music_Genre") + 
   xlab("Energy") + ylab("Music_Genre") + 
    geom_point(size = 1, shape = 18, color = "blue") + 
     theme_bw()
```




