---
title: "Music_PredictionEDA"
author: "Pavani Samala"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
library(ezids)
loadPkg("tree")
```


Reading in the dataset: All come in as expected (date is a character, but we don't need this because it's not really realted to the song data)

```{r}
setwd("/Users/pavan/Desktop/Git/6101 project/DS-6101-Final")
music = data.frame(read.csv("music_genre.csv"))
str(music)
```

```{r}
# drop those blank genre values 
music = music[!(music$music_genre == ""),]

```



Prepossessing the Genre Column with dummy variables
```{r}
#genres
new_genres<-c()
for (i in music$music_genre) 
  {
  if (i=="Electronic")
    new_genres<-append(new_genres,values='e')
  else
    new_genres<-append(new_genres,values='ne')
}
music$new_genres<-new_genres
music$new_genres = factor(music$new_genres)

new_modes<-c()
for (i in music$mode) 
  {
  if (i=="Minor")
    new_modes<-append(new_modes,values='m')
  else
    new_modes<-append(new_modes,values='nm')
}


music$new_modes<-new_modes
music$new_modes = factor(music$new_modes)

str(music)
```


```{r}

library(partykit)
treefit1<-ctree(new_genres ~ liveness + energy, data=music)
plot(treefit1)

treefit2<-ctree(new_genres ~ new_modes + energy, data=music)
plot(treefit2)

```


```{r, results = 'markup'}
loadPkg("rpart")

set.seed(1)
treefit <- rpart(mode ~ key + music_genre +liveness, data=music, method="class", control = list(maxdepth = 15) )
summary(treefit)
plot(treefit, uniform=TRUE, main="Classification Tree")

loadPkg("rattle")
fancyRpartPlot(treefit)


```



```